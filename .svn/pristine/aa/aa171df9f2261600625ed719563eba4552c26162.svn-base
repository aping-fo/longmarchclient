{"version":3,"sources":["Alert.js"],"names":["Alert","_alert","_detailLabel","_cancelButton","_enterButton","_enterCallBack","_animSpeed","_sprite","cc","Class","extends","Component","properties","statics","show","detailString","enterCallBack","needCancel","spritePath","animSpeed","self","undefined","loader","loadRes","Prefab","error","prefab","alert","instantiate","cbFadeOut","callFunc","onFadeOutFinish","cbFadeIn","onFadeInFinish","actionFadeIn","sequence","spawn","fadeTo","scaleTo","actionFadeOut","find","getComponent","Label","Sprite","spriteFrame","console","log","on","onButtonClicked","parent","startFadeIn","configAlert","string","active","x","SpriteFrame","err","eventManager","pauseTarget","position","p","setScale","opacity","runAction","startFadeOut","resumeTarget","onDestory","event","target","name","destroy","start"],"mappings":"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","file":"Alert.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\tools","sourcesContent":["import { ENFILE } from \"constants\";\r\n\r\nvar Alert = {\r\n    _alert: null,           // prefab\r\n    _detailLabel:   null,   // 内容\r\n    _cancelButton:  null,   // 确定按钮\r\n    _enterButton:   null,   // 取消按钮\r\n    _enterCallBack: null,   // 回调事件\r\n    _animSpeed:     0.3,    // 动画速度\r\n    _sprite:        null,   //人物\r\n};\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n\r\n    },\r\n\r\n\r\n    statics:{\r\n\r\n        /**\r\n         * detailString :   内容 string 类型.\r\n         * enterCallBack:   确定点击事件回调  function 类型.\r\n         * neeCancel:       是否展示取消按钮 bool 类型 default YES.\r\n         * spritePath:      动态加载弹框中精灵图片的resources路径\r\n         * duration:        动画速度 default = 0.3.\r\n        */\r\n        show(detailString, enterCallBack, needCancel, spritePath, animSpeed) {\r\n\r\n            var self = this;\r\n        \r\n            // 判断\r\n            if (Alert._alert != undefined) return;\r\n        \r\n            Alert._animSpeed = animSpeed ? animSpeed : Alert._animSpeed;\r\n            cc.loader.loadRes(\"prefabs/Alert\", cc.Prefab, function (error, prefab) {\r\n        \r\n                if (error) {\r\n                    cc.error(error);\r\n                    return;\r\n                }\r\n        \r\n                var alert = cc.instantiate(prefab);\r\n                Alert._alert = alert;\r\n        \r\n                // 动画 \r\n                var cbFadeOut = cc.callFunc(self.onFadeOutFinish, self);\r\n                var cbFadeIn = cc.callFunc(self.onFadeInFinish, self);\r\n                self.actionFadeIn = cc.sequence(cc.spawn(cc.fadeTo(Alert._animSpeed, 255), cc.scaleTo(Alert._animSpeed, 1.0)), cbFadeIn);\r\n                self.actionFadeOut = cc.sequence(cc.spawn(cc.fadeTo(Alert._animSpeed, 0), cc.scaleTo(Alert._animSpeed, 1.2)), cbFadeOut);\r\n        \r\n                \r\n                Alert._detailLabel = cc.find(\"alertBackground/detailLabel\", alert).getComponent(cc.Label);\r\n                Alert._cancelButton = cc.find(\"alertBackground/cancelButton\", alert);\r\n                Alert._enterButton = cc.find(\"alertBackground/enterButton\", alert);\r\n                Alert._sprite = cc.find(\"alertBackground/sprite\", alert).getComponent(cc.Sprite);\r\n\r\n                \r\n                if (Alert._sprite.spriteFrame) {\r\n                    console.log(\"Alert._sprite\");\r\n                }else{\r\n                    console.log(\"找不到\");\r\n                }\r\n                \r\n                // 添加点击事件\r\n                Alert._enterButton.on('click', self.onButtonClicked, self);\r\n                Alert._cancelButton.on('click', self.onButtonClicked, self);\r\n    \r\n                // 父视图\r\n                Alert._alert.parent = cc.find(\"Canvas\");\r\n        \r\n                // 展现 alert\r\n                self.startFadeIn();\r\n        \r\n                self.configAlert(detailString, enterCallBack, needCancel, spritePath,animSpeed);\r\n                \r\n            });\r\n        \r\n            // 参数\r\n            self.configAlert = function (detailString, enterCallBack, needCancel, spritePath, animSpeed) {\r\n        \r\n                // 回调\r\n                self._enterCallBack = enterCallBack;\r\n        \r\n                // 内容\r\n                Alert._detailLabel.string = detailString;\r\n                // 是否需要取消按钮\r\n                if (needCancel || needCancel == undefined) { // 显示\r\n                    Alert._cancelButton.active = true;\r\n                } else {  // 隐藏\r\n                    Alert._cancelButton.active = false;\r\n                    Alert._enterButton.x = 0;\r\n                }\r\n\r\n                if (spritePath == null || spritePath == undefined) {\r\n                    spritePath = \"Alert/alert_baby\";\r\n                }\r\n\r\n                cc.loader.loadRes(spritePath, cc.SpriteFrame, function (err, spriteFrame){\r\n                    console.log(spritePath);\r\n                    if (spriteFrame) {\r\n                        // if (Alert._sprite) {\r\n                        //     Alert._sprite.spriteFrame = spriteFrame;\r\n                        // }\r\n                    }\r\n\r\n                });\r\n\r\n            };\r\n        \r\n            // 执行弹进动画\r\n            self.startFadeIn = function () {\r\n                cc.eventManager.pauseTarget(Alert._alert, true);\r\n                Alert._alert.position = cc.p(0, 0);\r\n                Alert._alert.setScale(1.2);\r\n                Alert._alert.opacity = 0;\r\n                Alert._alert.runAction(self.actionFadeIn);\r\n            };\r\n        \r\n            // 执行弹出动画\r\n            self.startFadeOut = function () {\r\n                cc.eventManager.pauseTarget(Alert._alert, true);\r\n                if(Alert._alert != null)\r\n                {\r\n                    Alert._alert.runAction(self.actionFadeOut);\r\n                }\r\n            \r\n            };\r\n        \r\n            // 弹进动画完成回调\r\n            self.onFadeInFinish = function () {\r\n                cc.eventManager.resumeTarget(Alert._alert, true);\r\n            };\r\n        \r\n            // 弹出动画完成回调\r\n            self.onFadeOutFinish = function () {\r\n                self.onDestory();\r\n            };\r\n        \r\n            // 按钮点击事件\r\n            self.onButtonClicked = function(event){\r\n                if(event.target.name == \"enterButton\"){\r\n                    console.log(\"确认按钮\");\r\n                    if(self._enterCallBack){\r\n                    \r\n                        self._enterCallBack();\r\n                        self.onDestory();\r\n                    }\r\n                }else{\r\n                    console.log(\"取消按钮\");\r\n                    self.startFadeOut();\r\n                }\r\n               \r\n            };\r\n        \r\n            // 销毁 alert \r\n            self.onDestory = function () {\r\n                Alert._alert.destroy();\r\n                Alert._enterCallBack = null;\r\n                Alert._alert = null;\r\n                Alert._detailLabel = null;\r\n                Alert._cancelButton = null;\r\n                Alert._enterButton = null;\r\n                Alert._animSpeed = 0.3;\r\n                Alert._sprite = null;\r\n\r\n            };\r\n        }\r\n\r\n\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n   \r\n});"]}