{"version":3,"sources":["AudioManager.js"],"names":["LOCALSTORAGEKEY_BgmOn","LOCALSTORAGEKEY_ClipOn","AudioManager","cc","Class","extends","Component","statics","_instance","getInstance","MUSIC_TYPE","Enum","NORMAL","FIGHT","EFFECT_TYPE","BUTTON","POPUP","MONEY","FIRE","FAIL","SUCCESS","CHICKEN_GAME_START","CHICKEN_GAME_START_GO","init","m_effectIdMapping","m_bgmOn","m_clipOn","m_bgMusic","m_fightBgMusic","m_playingMusic","m_clickClip","m_popupClip","m_moneyClip","_this","loader","loadRes","AudioClip","err","audioClip","error","message","playMusic","m_fireClip","m_failClip","m_successClip","m_gameStartClip","m_gameStartClip2","bgmOn","sys","localStorage","getItem","setBgmOn","clipOn","setClipOn","isOn","setItem","audioEngine","setMusicVolume","isBgmOn","setEffectsVolume","isClipOn","type","isLoop","clip","playEffect","id","stopEffect"],"mappings":"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","file":"AudioManager.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const LOCALSTORAGEKEY_BgmOn = \"BgmOn\";\r\nconst LOCALSTORAGEKEY_ClipOn = \"ClipOn\";\r\n\r\nvar AudioManager = cc.Class({\r\n    extends: cc.Component,\r\n    statics: {\r\n        _instance: null,\r\n        getInstance: function () {\r\n            if (!AudioManager._instance) {\r\n                AudioManager._instance = new AudioManager();\r\n            }\r\n            return AudioManager._instance;\r\n        },\r\n\r\n        MUSIC_TYPE: cc.Enum({\r\n            NORMAL: 0,\r\n            FIGHT: 1\r\n        }),\r\n        \r\n        EFFECT_TYPE: cc.Enum({\r\n            BUTTON: 0,\r\n            POPUP: 1,\r\n            MONEY: 2,\r\n\r\n            FIRE: 10,\r\n            FAIL: 11,\r\n            SUCCESS: 12,\r\n            CHICKEN_GAME_START:13,\r\n            CHICKEN_GAME_START_GO:14\r\n        }),\r\n    },\r\n\r\n    init(){\r\n        this.m_effectIdMapping = [];\r\n\r\n        this.m_bgmOn = false;\r\n        this.m_clipOn = false;\r\n        this.m_bgMusic = null;\r\n        this.m_fightBgMusic = null;\r\n        this.m_playingMusic = null;\r\n\r\n        this.m_clickClip = null;\r\n        this.m_popupClip = null;\r\n        this.m_moneyClip = null;\r\n\r\n        var _this = this;\r\n\r\n        cc.loader.loadRes(\"music/bg\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_bgMusic = audioClip;\r\n            _this.playMusic(AudioManager.MUSIC_TYPE.FIGHT);\r\n        });\r\n\r\n        cc.loader.loadRes(\"music/bg1\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_fightBgMusic = audioClip;\r\n        });\r\n\r\n        cc.loader.loadRes(\"audio/popup\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_popupClip = audioClip;\r\n        });\r\n\r\n        cc.loader.loadRes(\"audio/button\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_clickClip = audioClip;\r\n        });\r\n        \r\n        cc.loader.loadRes(\"audio/money\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_moneyClip = audioClip;\r\n        });\r\n        \r\n        cc.loader.loadRes(\"audio/fire\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_fireClip = audioClip;\r\n        });\r\n        \r\n        cc.loader.loadRes(\"audio/fail\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_failClip = audioClip;\r\n        });\r\n        \r\n        cc.loader.loadRes(\"audio/success\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_successClip = audioClip;\r\n        });\r\n        cc.loader.loadRes(\"audio/Countdown\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_gameStartClip = audioClip;\r\n        });\r\n        cc.loader.loadRes(\"audio/Countdown2\", cc.AudioClip, function (err, audioClip) {\r\n            if (err) {\r\n                cc.error(err.message || err);\r\n                return;\r\n            }\r\n            _this.m_gameStartClip2 = audioClip;\r\n        });\r\n        \r\n\r\n        //背景音乐\r\n        var bgmOn = cc.sys.localStorage.getItem(LOCALSTORAGEKEY_BgmOn) == null || cc.sys.localStorage.getItem(LOCALSTORAGEKEY_BgmOn) == \"\" ? true : cc.sys.localStorage.getItem(LOCALSTORAGEKEY_BgmOn) == \"true\" ? true : false;\r\n        this.setBgmOn(bgmOn);\r\n\r\n        //音效\r\n        var clipOn = cc.sys.localStorage.getItem(LOCALSTORAGEKEY_ClipOn) == null || cc.sys.localStorage.getItem(LOCALSTORAGEKEY_ClipOn) == \"\" ? true : cc.sys.localStorage.getItem(LOCALSTORAGEKEY_ClipOn) == \"true\" ? true : false;\r\n        this.setClipOn(clipOn);\r\n    },\r\n    \r\n    setBgmOn(isOn) {\r\n        this.m_bgmOn = isOn;\r\n        cc.sys.localStorage.setItem(LOCALSTORAGEKEY_BgmOn, isOn ? \"true\" : \"false\");\r\n\r\n        cc.audioEngine.setMusicVolume(isOn ? 1 : 0);\r\n    },\r\n\r\n    isBgmOn() {\r\n        return this.m_bgmOn;\r\n    },\r\n\r\n    setClipOn(isOn) {\r\n        this.m_clipOn = isOn;\r\n        cc.sys.localStorage.setItem(LOCALSTORAGEKEY_ClipOn, isOn ? \"true\" : \"false\");\r\n\r\n        cc.audioEngine.setEffectsVolume(isOn ? 1 : 0);\r\n    },\r\n\r\n    isClipOn() {\r\n        return this.m_clipOn;\r\n    },\r\n\r\n    playMusic(type, isLoop) {\r\n\r\n        if (isLoop == null) {\r\n            isLoop = true;\r\n        }\r\n\r\n        var clip = null;\r\n\r\n        switch(type){\r\n            case AudioManager.MUSIC_TYPE.NORMAL:\r\n                clip = this.m_bgMusic;\r\n                break;\r\n\r\n            case AudioManager.MUSIC_TYPE.FIGHT:\r\n                clip = this.m_fightBgMusic;\r\n                break;\r\n        }\r\n\r\n        if(this.m_playingMusic == clip){\r\n            return;\r\n        }\r\n\r\n        cc.audioEngine.playMusic(clip, isLoop);\r\n        this.m_playingMusic = clip;\r\n    },\r\n\r\n    playEffect(type) {\r\n        var clip = null;\r\n\r\n        switch(type){\r\n            case AudioManager.EFFECT_TYPE.BUTTON:\r\n                clip = this.m_clickClip;\r\n                break;\r\n\r\n            case AudioManager.EFFECT_TYPE.POPUP:\r\n                clip = this.m_popupClip;\r\n                break;\r\n\r\n            case AudioManager.EFFECT_TYPE.MONEY:\r\n                clip = this.m_moneyClip;\r\n                break;\r\n\r\n            case AudioManager.EFFECT_TYPE.FIRE:\r\n                clip = this.m_fireClip;\r\n                break;\r\n\r\n                \r\n            case AudioManager.EFFECT_TYPE.FAIL:\r\n                clip = this.m_failClip;\r\n            break;\r\n\r\n            case AudioManager.EFFECT_TYPE.SUCCESS:\r\n                clip = this.m_successClip;\r\n                break;\r\n\r\n            case AudioManager.EFFECT_TYPE.CHICKEN_GAME_START:\r\n                clip = this.m_gameStartClip;\r\n                break;\r\n\r\n            case AudioManager.EFFECT_TYPE.CHICKEN_GAME_START_GO:\r\n                clip = this.m_gameStartClip2;\r\n                break;\r\n        }\r\n\r\n        let id = cc.audioEngine.playEffect(clip);\r\n        this.m_effectIdMapping[type] = id;\r\n    },\r\n\r\n    stopEffect(type){\r\n        if(this.m_effectIdMapping[type] == null){\r\n            return;\r\n        }\r\n\r\n        cc.audioEngine.stopEffect(this.m_effectIdMapping[type]);\r\n        this.m_effectIdMapping[type] = null;\r\n    }\r\n});"]}