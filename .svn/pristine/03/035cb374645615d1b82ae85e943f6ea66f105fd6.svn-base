{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\ReviewPanel.js"],"names":["HistoryQuestionModel","require","GameManager","UIHelper","WXTool","cc","Class","extends","Component","properties","leftPageBtn","type","Button","default","rightPageBtn","contentNode","Node","shareNode","saveWithoutNodes","pageNumLb","Label","saveHeigth","onLoad","start","m_datas","m_pageIndex","_this","getInstance","getDatas","resp","console","log","questions","updateContent","active","node","getComponent","Animation","play","onEnable","item","data","find","string","content","explain","answer","maxPageIndex","length","saveImageToAlbum","SaveCanvas","path","result","onLeftPageBtnClick","btn","onRightPageBtnClick","onSaveBtnClick","onCloseBtnClick","LoadScene","onShareCloseBtnClick","onShareBtnClick","share","onSaveCanvasBtnClick"],"mappings":"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","file":"ReviewPanel.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nvar HistoryQuestionModel = require(\"HistoryQuestionModel\");\r\nvar GameManager = require(\"GameManager\");\r\nvar UIHelper = require(\"UIHelper\");\r\nvar WXTool = require(\"WXTool\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // pageView: {\r\n        //     type: cc.PageView,\r\n        //     default: null\r\n        // },\r\n\r\n        leftPageBtn: {\r\n            type: cc.Button,\r\n            default: null\r\n        },\r\n\r\n        rightPageBtn: {\r\n            type: cc.Button,\r\n            default: null\r\n        },\r\n\r\n        contentNode: {\r\n            type: cc.Node,\r\n            default: null\r\n        },\r\n\r\n        shareNode: {\r\n            type: cc.Node,\r\n            default: null\r\n        },\r\n\r\n        saveWithoutNodes: [cc.Node],\r\n\r\n        pageNumLb: {\r\n            type: cc.Label,\r\n            default: null\r\n        },\r\n\r\n        saveHeigth: 1000\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n    },\r\n\r\n    start () {\r\n        this.m_datas = null;\r\n        this.m_pageIndex = 0;\r\n\r\n        var _this = this;\r\n\r\n        HistoryQuestionModel.getInstance().getDatas(function(resp){\r\n            console.log(\"HistoryQuestionModel\", resp);\r\n            _this.m_datas = resp.questions;\r\n            _this.updateContent();\r\n        });\r\n\r\n        this.shareNode.active = false;\r\n        this.node.getComponent(cc.Animation).play(\"review_2\");\r\n    },\r\n\r\n    onEnable(){\r\n\r\n    },\r\n\r\n    updateContent(){\r\n        var item = this.contentNode;\r\n        var data = this.m_datas[this.m_pageIndex];\r\n\r\n        if(data != null){\r\n            cc.find(\"pop_1/lb_question\", item).active = true;\r\n            cc.find(\"pop_3/lb_explain\", item).active = true;\r\n            cc.find(\"pop_2/right\", item).active = true;\r\n            cc.find(\"pop_2/wrong\", item).active = true;\r\n\r\n            cc.find(\"pop_1/lb_question\", item).getComponent(cc.Label).string = data.content;\r\n            cc.find(\"pop_3/lb_explain\", item).getComponent(cc.Label).string = data.explain;\r\n            cc.find(\"pop_2/right\", item).active = data.answer == \"正确\";\r\n            cc.find(\"pop_2/wrong\", item).active = data.answer != \"正确\";\r\n        }else{\r\n            cc.find(\"pop_1/lb_question\", item).active = false;\r\n            cc.find(\"pop_3/lb_explain\", item).active = false;\r\n            cc.find(\"pop_2/right\", item).active = false;\r\n            cc.find(\"pop_2/wrong\", item).active = false;\r\n        }\r\n\r\n        var maxPageIndex = this.m_datas.length;\r\n        this.pageNumLb.string = (this.m_pageIndex + 1) + \"/\" + maxPageIndex;\r\n\r\n        this.leftPageBtn.node.active = this.m_pageIndex > 0;\r\n        this.rightPageBtn.node.active = this.m_pageIndex + 1 < maxPageIndex;\r\n    },\r\n\r\n    saveImageToAlbum(){\r\n        UIHelper.SaveCanvas(this.saveWithoutNodes, false, function(path){\r\n            if(path != \"\"){\r\n                WXTool.getInstance().saveImageToAlbum(path, function(result){\r\n                    if(result == \"success\"){\r\n                        console.log(\"成功\");\r\n                    }else{\r\n                        console.log(\"失败\");\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    onLeftPageBtnClick(btn){\r\n        if(this.m_datas == null){\r\n            return;\r\n        }\r\n        this.m_pageIndex--;\r\n        this.updateContent();\r\n    },\r\n\r\n    onRightPageBtnClick(btn){\r\n        if(this.m_datas == null){\r\n            return;\r\n        }\r\n        this.m_pageIndex++;\r\n        this.updateContent();\r\n    },\r\n\r\n    onSaveBtnClick(btn){\r\n        if(this.m_datas == null){\r\n            return;\r\n        }\r\n        this.shareNode.active = true;\r\n    },\r\n\r\n    onCloseBtnClick(btn){\r\n        GameManager.getInstance().LoadScene(\"main\");\r\n    },\r\n\r\n    ////////////////////////////  分享弹框  ////////////////////////////\r\n    onShareCloseBtnClick(btn){\r\n        this.shareNode.active = false;\r\n    },\r\n\r\n    onShareBtnClick(btn){\r\n        WXTool.getInstance().share();\r\n    },\r\n\r\n    onSaveCanvasBtnClick(btn){\r\n        this.saveImageToAlbum();\r\n    }\r\n});\r\n"]}